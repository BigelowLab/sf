<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tidyverse methods for sf objects (remove .sf suffix!) — tidyverse • sf</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Tidyverse methods for sf objects (remove .sf suffix!) — tidyverse" />
<meta property="og:description" content="Tidyverse methods for sf objects. Geometries are sticky, use as.data.frame to let dplyr's own methods drop them. Use these methods without the .sf suffix and after loading the tidyverse package with the generic (or after loading package tidyverse)." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9-9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sf1.html">1. Simple Features for R</a>
    </li>
    <li>
      <a href="../articles/sf2.html">2. Reading, Writing and Converting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf3.html">3. Manipulating Simple Feature Geometries</a>
    </li>
    <li>
      <a href="../articles/sf4.html">4. Manipulating Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf5.html">5. Plotting Simple Features</a>
    </li>
    <li>
      <a href="../articles/sf6.html">6. Miscellaneous</a>
    </li>
    <li>
      <a href="../articles/sf7.html">7. Spherical geometry in sf using s2geometry</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-spatial/sf/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tidyverse methods for sf objects (remove .sf suffix!)</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-spatial/sf/blob/master/R/tidyverse.R'><code>R/tidyverse.R</code></a>, <a href='https://github.com/r-spatial/sf/blob/master/R/join.R'><code>R/join.R</code></a></small>
    <div class="hidden name"><code>tidyverse.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Tidyverse methods for sf objects. Geometries are sticky, use <a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a> to let <code>dplyr</code>'s own methods drop them. Use these methods without the .sf suffix and after loading the tidyverse package with the generic (or after loading package tidyverse).</p>
    </div>

    <pre class="usage"><span class='fu'>filter.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span><span class='op'>)</span>

<span class='fu'>arrange.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span><span class='op'>)</span>

<span class='fu'>group_by.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, add <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>ungroup.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>rowwise.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>mutate.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span><span class='op'>)</span>

<span class='fu'>transmute.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span><span class='op'>)</span>

<span class='fu'>select.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>rename.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>slice.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span><span class='op'>)</span>

<span class='fu'>summarise.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, <span class='va'>.dots</span>, do_union <span class='op'>=</span> <span class='cn'>TRUE</span>, is_coverage <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>distinct.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span>, .keep_all <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>gather.sf</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>key</span>,
  <span class='va'>value</span>,
  <span class='va'>...</span>,
  na.rm <span class='op'>=</span> <span class='cn'>FALSE</span>,
  convert <span class='op'>=</span> <span class='cn'>FALSE</span>,
  factor_key <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>spread.sf</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>key</span>,
  <span class='va'>value</span>,
  fill <span class='op'>=</span> <span class='cn'>NA</span>,
  convert <span class='op'>=</span> <span class='cn'>FALSE</span>,
  drop <span class='op'>=</span> <span class='cn'>TRUE</span>,
  sep <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span>

<span class='fu'>sample_n.sf</span><span class='op'>(</span><span class='va'>tbl</span>, <span class='va'>size</span>, replace <span class='op'>=</span> <span class='cn'>FALSE</span>, weight <span class='op'>=</span> <span class='cn'>NULL</span>, .env <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>sample_frac.sf</span><span class='op'>(</span>
  <span class='va'>tbl</span>,
  size <span class='op'>=</span> <span class='fl'>1</span>,
  replace <span class='op'>=</span> <span class='cn'>FALSE</span>,
  weight <span class='op'>=</span> <span class='cn'>NULL</span>,
  .env <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sys.parent.html'>parent.frame</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='fu'>nest.sf</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>separate.sf</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>col</span>,
  <span class='va'>into</span>,
  sep <span class='op'>=</span> <span class='st'>"[^[:alnum:]]+"</span>,
  remove <span class='op'>=</span> <span class='cn'>TRUE</span>,
  convert <span class='op'>=</span> <span class='cn'>FALSE</span>,
  extra <span class='op'>=</span> <span class='st'>"warn"</span>,
  fill <span class='op'>=</span> <span class='st'>"warn"</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='fu'>separate_rows.sf</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>...</span>, sep <span class='op'>=</span> <span class='st'>"[^[:alnum:]]+"</span>, convert <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='fu'>unite.sf</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>col</span>, <span class='va'>...</span>, sep <span class='op'>=</span> <span class='st'>"_"</span>, remove <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'>unnest.sf</span><span class='op'>(</span><span class='va'>data</span>, <span class='va'>...</span>, .preserve <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>inner_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>left_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>right_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>full_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>semi_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>anti_join.sf</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, by <span class='op'>=</span> <span class='cn'>NULL</span>, copy <span class='op'>=</span> <span class='cn'>FALSE</span>, suffix <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>".x"</span>, <span class='st'>".y"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>data object of class <a href='sf.html'>sf</a></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>other arguments</p></td>
    </tr>
    <tr>
      <th>.dots</th>
      <td><p>see corresponding function in package <code>dplyr</code></p></td>
    </tr>
    <tr>
      <th>add</th>
      <td><p>see corresponding function in dplyr</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A pair of data frames, data frame extensions (e.g. a tibble), or
lazy data frames (e.g. from dbplyr or dtplyr). See <em>Methods</em>, below, for
more details.</p></td>
    </tr>
    <tr>
      <th>do_union</th>
      <td><p>logical; in case <code>summary</code> does not create a geometry column, should geometries be created by unioning using <a href='geos_combine.html'>st_union</a>, or simply by combining using <a href='geos_combine.html'>st_combine</a>? Using <a href='geos_combine.html'>st_union</a> resolves internal boundaries, but in case of unioning points, this will likely change the order of the points; see Details.</p></td>
    </tr>
    <tr>
      <th>is_coverage</th>
      <td><p>logical; if <code>do_union</code> is <code>TRUE</code>, use an optimized algorithm for features that form a polygonal coverage (have no overlaps)</p></td>
    </tr>
    <tr>
      <th>.keep_all</th>
      <td><p>see corresponding function in dplyr</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>key</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>convert</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></p></td>
    </tr>
    <tr>
      <th>factor_key</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>fill</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate_rows.html'>separate_rows</a></p></td>
    </tr>
    <tr>
      <th>tbl</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>replace</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>weight</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>.env</th>
      <td><p>see original function docs</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></p></td>
    </tr>
    <tr>
      <th>into</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></p></td>
    </tr>
    <tr>
      <th>remove</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></p></td>
    </tr>
    <tr>
      <th>extra</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></p></td>
    </tr>
    <tr>
      <th>.preserve</th>
      <td><p>see <a href='https://tidyr.tidyverse.org/reference/nest.html'>unnest</a></p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>A pair of data frames, data frame extensions (e.g. a tibble), or
lazy data frames (e.g. from dbplyr or dtplyr). See <em>Methods</em>, below, for
more details.</p></td>
    </tr>
    <tr>
      <th>by</th>
      <td><p>A character vector of variables to join by.</p>
<p>If <code>NULL</code>, the default, <code>*_join()</code> will perform a natural join, using all
variables in common across <code>x</code> and <code>y</code>. A message lists the variables so that you
can check they're correct; suppress the message by supplying <code>by</code> explicitly.</p>
<p>To join by different variables on <code>x</code> and <code>y</code>, use a named vector.
For example, <code>by = c("a" = "b")</code> will match <code>x$a</code> to <code>y$b</code>.</p>
<p>To join by multiple variables, use a vector with length &gt; 1.
For example, <code>by = c("a", "b")</code> will match <code>x$a</code> to <code>y$a</code> and <code>x$b</code> to
<code>y$b</code>. Use a named vector to match different variables in <code>x</code> and <code>y</code>.
For example, <code>by = c("a" = "b", "c" = "d")</code> will match <code>x$a</code> to <code>y$b</code> and
<code>x$c</code> to <code>y$d</code>.</p>
<p>To perform a cross-join, generating all combinations of <code>x</code> and <code>y</code>,
use <code>by = character()</code>.</p></td>
    </tr>
    <tr>
      <th>copy</th>
      <td><p>If <code>x</code> and <code>y</code> are not from the same data source,
and <code>copy</code> is <code>TRUE</code>, then <code>y</code> will be copied into the
same src as <code>x</code>.  This allows you to join tables across srcs, but
it is a potentially expensive operation so you must opt into it.</p></td>
    </tr>
    <tr>
      <th>suffix</th>
      <td><p>If there are non-joined duplicate variables in <code>x</code> and
<code>y</code>, these suffixes will be added to the output to disambiguate them.
Should be a character vector of length 2.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class <a href='sf.html'>sf</a></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>select</code> keeps the geometry regardless whether it is selected or not; to deselect it, first pipe through <code>as.data.frame</code> to let dplyr's own <code>select</code> drop it.</p>
<p>In case one or more of the arguments (expressions) in the <code>summarise</code> call creates a geometry list-column, the first of these will be the (active) geometry of the returned object. If this is not the case, a geometry column is created, depending on the value of <code>do_union</code>.</p>
<p>In case <code>do_union</code> is <code>FALSE</code>, <code>summarise</code> will simply combine geometries using <a href='st.html'>c.sfg</a>. When polygons sharing a boundary are combined, this leads to geometries that are invalid; see for instance <a href='https://github.com/r-spatial/sf/issues/681'>https://github.com/r-spatial/sf/issues/681</a>.</p>
<p><code>distinct</code> gives distinct records for which all attributes and geometries are distinct; <a href='geos_binary_pred.html'>st_equals</a> is used to find out which geometries are distinct.</p>
<p><code>nest</code> assumes that a simple feature geometry list-column was among the columns that were nested.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>=</span> <span class='fu'><a href='st_read.html'>st_read</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"shape/nc.shp"</span>, package<span class='op'>=</span><span class='st'>"sf"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Reading layer `nc' from data source 
#&gt;   `/tmp/RtmpFha8Gk/temp_libpathe3b9509189bf/sf/shape/nc.shp' 
#&gt;   using driver `ESRI Shapefile'
#&gt; Simple feature collection with 100 features and 14 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
#&gt; Geodetic CRS:  NAD27</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>AREA</span> <span class='op'>&gt;</span> <span class='fl'>.1</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: plotting the first 10 out of 14 attributes; use max.plot = 14 to plot all</span></div><div class='img'><img src='tidyverse-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># plot 10 smallest counties in grey:</span>
<span class='fu'><a href='st_geometry.html'>st_geometry</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>AREA</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='va'>AREA</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span>add <span class='op'>=</span> <span class='cn'>TRUE</span>, col <span class='op'>=</span> <span class='st'>'grey'</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='st'>"the ten counties with smallest area"</span><span class='op'>)</span>
</div><div class='img'><img src='tidyverse-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>nc</span><span class='op'>$</span><span class='va'>area_cl</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>$</span><span class='va'>AREA</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.1</span>, <span class='fl'>.12</span>, <span class='fl'>.15</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>area_cl</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "sf"         "grouped_df" "tbl_df"     "tbl"        "data.frame"</div><div class='input'><span class='va'>nc2</span> <span class='op'>&lt;-</span> <span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>area10 <span class='op'>=</span> <span class='va'>AREA</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span>AREA <span class='op'>=</span> <span class='va'>AREA</span><span class='op'>/</span><span class='fl'>10</span>, geometry <span class='op'>=</span> <span class='va'>geometry</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "sf"         "data.frame"</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>transmute</a></span><span class='op'>(</span>AREA <span class='op'>=</span> <span class='va'>AREA</span><span class='op'>/</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "sf"         "data.frame"</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "SID74"    "SID79"    "geometry"</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span>, <span class='va'>geometry</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "SID74"    "SID79"    "geometry"</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "sf"         "data.frame"</div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span>, <span class='va'>geometry</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "sf"         "data.frame"</div><div class='input'><span class='va'>nc2</span> <span class='op'>&lt;-</span> <span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>area <span class='op'>=</span> <span class='va'>AREA</span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/slice.html'>slice</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Simple feature collection with 2 features and 15 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -81.74107 ymin: 36.23436 xmax: -80.90344 ymax: 36.58965
#&gt; Geodetic CRS:  NAD27
#&gt;    AREA PERIMETER CNTY_ CNTY_ID      NAME  FIPS FIPSNO CRESS_ID BIR74 SID74
#&gt; 1 0.114     1.442  1825    1825      Ashe 37009  37009        5  1091     1
#&gt; 2 0.061     1.231  1827    1827 Alleghany 37005  37005        3   487     0
#&gt;   NWBIR74 BIR79 SID79 NWBIR79    area_cl                       geometry
#&gt; 1      10  1364     0      19 (0.1,0.12] MULTIPOLYGON (((-81.47276 3...
#&gt; 2      10   542     3      12    (0,0.1] MULTIPOLYGON (((-81.23989 3...</div><div class='input'><span class='va'>nc</span><span class='op'>$</span><span class='va'>area_cl</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>nc</span><span class='op'>$</span><span class='va'>AREA</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>.1</span>, <span class='fl'>.12</span>, <span class='fl'>.15</span>, <span class='fl'>.25</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>nc.g</span> <span class='op'>&lt;-</span> <span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>area_cl</span><span class='op'>)</span>
<span class='va'>nc.g</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>AREA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; Simple feature collection with 4 features and 2 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -84.32385 ymin: 33.88199 xmax: -75.45698 ymax: 36.58965
#&gt; Geodetic CRS:  NAD27
#&gt; <span style='color: #949494;'># A tibble: 4 x 3</span><span>
#&gt;   area_cl    `mean(AREA)`                                               geometry
#&gt;   </span><span style='color: #949494;font-style: italic;'>&lt;fct&gt;</span><span>             </span><span style='color: #949494;font-style: italic;'>&lt;dbl&gt;</span><span>                                     </span><span style='color: #949494;font-style: italic;'>&lt;MULTIPOLYGON [°]&gt;</span><span>
#&gt; </span><span style='color: #BCBCBC;'>1</span><span> (0,0.1]          0.076</span><span style='text-decoration: underline;'>0</span><span> (((-77.96073 34.18924, -77.96587 34.24229, -77.97528 …
#&gt; </span><span style='color: #BCBCBC;'>2</span><span> (0.1,0.12]       0.112  (((-84.29104 35.21054, -84.22594 35.2616, -84.17973 3…
#&gt; </span><span style='color: #BCBCBC;'>3</span><span> (0.12,0.1…       0.134  (((-76.54427 34.58783, -76.55515 34.61066, -76.53775 …
#&gt; </span><span style='color: #BCBCBC;'>4</span><span> (0.15,0.2…       0.190  (((-78.02592 34.32877, -78.01131 34.31261, -78.00702 …</div><div class='input'><span class='va'>nc.g</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>AREA</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span>col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/gray.html'>grey</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>6</span> <span class='op'>/</span> <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='output co'>#&gt; <span class='message'>although coordinates are longitude/latitude, st_union assumes that they are planar</span></div><div class='img'><img src='tidyverse-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='va'>as.data.frame</span> <span class='op'>%&gt;%</span> <span class='fu'>summarise</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>AREA</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   mean(AREA)
#&gt; 1    0.12626</div><div class='input'><span class='va'>nc</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/distinct.html'>distinct</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 100</div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span><span class='op'>(</span><span class='st'>"VAR"</span>, <span class='st'>"SID"</span>, <span class='op'>-</span><span class='va'>geometry</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      VAR                 SID                  geometry  
#&gt;  Length:200         Min.   : 0.000   MULTIPOLYGON :200  
#&gt;  Class :character   1st Qu.: 2.000   epsg:4267    :  0  
#&gt;  Mode  :character   Median : 5.000   +proj=long...:  0  
#&gt;                     Mean   : 7.515                      
#&gt;                     3rd Qu.: 9.000                      
#&gt;                     Max.   :57.000                      </div><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyr.tidyverse.org'>tidyr</a></span><span class='op'>)</span>
<span class='va'>nc</span><span class='op'>$</span><span class='va'>row</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span> <span class='co'># needed for spread to work</span>
<span class='va'>nc</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/select.html'>select</a></span><span class='op'>(</span><span class='va'>SID74</span>, <span class='va'>SID79</span>, <span class='va'>geometry</span>, <span class='va'>row</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/gather.html'>gather</a></span><span class='op'>(</span><span class='st'>"VAR"</span>, <span class='st'>"SID"</span>, <span class='op'>-</span><span class='va'>geometry</span>, <span class='op'>-</span><span class='va'>row</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://tidyr.tidyverse.org/reference/spread.html'>spread</a></span><span class='op'>(</span><span class='va'>VAR</span>, <span class='va'>SID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Simple feature collection with 6 features and 3 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: -81.74107 ymin: 36.07282 xmax: -75.77316 ymax: 36.58965
#&gt; Geodetic CRS:  NAD27
#&gt;   row SID74 SID79                       geometry
#&gt; 1   1     1     0 MULTIPOLYGON (((-81.47276 3...
#&gt; 2   2     0     3 MULTIPOLYGON (((-81.23989 3...
#&gt; 3   3     5     6 MULTIPOLYGON (((-80.45634 3...
#&gt; 4   4     1     2 MULTIPOLYGON (((-76.00897 3...
#&gt; 5   5     9     3 MULTIPOLYGON (((-77.21767 3...
#&gt; 6   6     7     5 MULTIPOLYGON (((-76.74506 3...</div><div class='input'><span class='va'>storms.sf</span> <span class='op'>=</span> <span class='fu'><a href='st_as_sf.html'>st_as_sf</a></span><span class='op'>(</span><span class='va'>storms</span>, coords <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"long"</span>, <span class='st'>"lat"</span><span class='op'>)</span>, crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>storms.sf</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>name</span>, <span class='va'>year</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>nest</span>
<span class='va'>trs</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>data</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>tr</span><span class='op'>)</span> <span class='fu'><a href='st_cast.html'>st_cast</a></span><span class='op'>(</span><span class='fu'><a href='geos_combine.html'>st_combine</a></span><span class='op'>(</span><span class='va'>tr</span><span class='op'>)</span>, <span class='st'>"LINESTRING"</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='sfc.html'>st_sfc</a></span><span class='op'>(</span>crs <span class='op'>=</span> <span class='fl'>4326</span><span class='op'>)</span>
<span class='va'>trs.sf</span> <span class='op'>=</span> <span class='fu'><a href='sf.html'>st_sf</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, <span class='va'>trs</span><span class='op'>)</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>trs.sf</span><span class='op'>[</span><span class='st'>"year"</span><span class='op'>]</span>, axes <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='img'><img src='tidyverse-4.png' alt='' width='700' height='433' /></div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Edzer Pebesma.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


